<!-- services/web-app/templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gemini Document Scanner</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: auto; padding: 20px; background: #f4f7f6; }
        .container { background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        .form-group { margin-bottom: 20px; }
        label { font-weight: bold; display: block; margin-bottom: 5px; }
        input[type="file"] { width: 100%; padding: 8px; box-sizing: border-box; }
        button { background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; width: 100%; }
        button:hover { background: #0056b3; }
        #response { margin-top: 20px; padding: 15px; border-radius: 5px; background: #e9ecef; white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Gemini-Powered Document Scanner</h1>
        <form id="upload-form">
            <div class="form-group">
                <label for="front-image">Front of Document:</label>
                <input type="file" id="front-image" name="front_image" accept="image/*">
            </div>
            <div class="form-group">
                <label for="back-image">Back of Document:</label>
                <input type="file" id="back-image" name="back_image" accept="image/*">
            </div>
            <button type="submit">Scan Document</button>
        </form>
        <div id="response">Your results will appear here...</div>
    </div>

<script>
document.getElementById('upload-form').addEventListener('submit', async function(event) {
    event.preventDefault();
    const responseDiv = document.getElementById('response');
    responseDiv.textContent = 'Uploading and queuing job... Please wait.';

    const formData = new FormData();
    const frontImage = document.getElementById('front-image').files[0];
    const backImage = document.getElementById('back-image').files[0];

    if (frontImage) formData.append('front_image', frontImage);
    if (backImage) formData.append('back_image', backImage);

    try {
        const response = await fetch('/scan', {
            method: 'POST',
            body: formData,
        });
        const data = await response.json();
        if (response.ok) {
            responseDiv.style.color = 'green';
            responseDiv.textContent = `Success!\n${data.message}\n\nThe worker will process this in the background. Check your database for the result.`;
        } else {
            responseDiv.style.color = 'red';
            responseDiv.textContent = `Error: ${data.error}`;
        }
    } catch (error) {
        responseDiv.style.color = 'red';
        responseDiv.textContent = `Network Error: ${error}`;
    }
});
</script>
</body>
</html>